# Last Modified: Tue Dec 30 17:57:05 2025
include <tunables/global>

/usr/local/sbin/secure-admin flags=(enforce) {
  include <abstractions/base>
  include <abstractions/nameservice>

  capability audit_write,
  capability chown,
  capability dac_override,
  capability dac_read_search,
  capability fowner,
  capability fsetid,

  /dev/pts/* rw,
  /dev/tty rw,
  /etc/.pwd.lock rwlk,
  /etc/default/useradd r,
  /etc/group rw,
  /etc/group+ rw,
  /etc/group- rw,
  /etc/group.* rwk,
  /etc/group.lock rwlk,
  /etc/gshadow rw,
  /etc/gshadow+ rw,
  /etc/gshadow- rw,
  /etc/gshadow.* rwk,
  /etc/gshadow.lock rwlk,
  /etc/login.defs r,
  /etc/passwd rw,
  /etc/passwd+ rw,
  /etc/passwd- rw,
  /etc/passwd.* rwk,
  /etc/passwd.lock rwlk,
  /etc/shadow rw,
  /etc/shadow+ rw,
  /etc/shadow- rw,
  /etc/shadow.* rwk,
  /etc/shadow.lock rwlk,
  /etc/skel/ r,
  /etc/skel/** r,
  /etc/subgid rw,
  /etc/subgid+ rw,
  /etc/subgid- rw,
  /etc/subgid.* rwk,
  /etc/subgid.lock rwlk,
  /etc/subuid rw,
  /etc/subuid+ rw,
  /etc/subuid- rw,
  /etc/subuid.* rwk,
  /etc/subuid.lock rwlk,
  /home/ w,
  /home/*/ rw,
  /home/*/** rwk,
  /home/*/.google_authenticator r,
  /proc/filesystems r,
  /proc/sys/kernel/cap_last_cap r,
  /proc/sys/kernel/ngroups_max r,
  /proc/sys/kernel/random/boot_id r,
  /usr/bin/python3 ix,
  /usr/bin/python3.13 ix,
  /usr/local/sbin/secure-admin r,
  /usr/sbin/useradd mrix,
  /usr/sbin/usermod mrix,
  /var/lib/risktotp/ rwk,
  /var/lib/risktotp/** rwk,
  /var/log/risktotp/ rwk,
  /var/log/risktotp/** rwk,
  link /etc/group.* -> /etc/group.lock,
  link /etc/gshadow.* -> /etc/gshadow.lock,
  link /etc/passwd.* -> /etc/passwd.lock,
  link /etc/shadow.* -> /etc/shadow.lock,
  link /etc/subgid.* -> /etc/subgid.lock,
  link /etc/subuid.* -> /etc/subuid.lock,
  owner /usr/local/sbin/ r,

}
